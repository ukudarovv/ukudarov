{% extends 'index.html' %}
{% load static %}

{% block title %}
    GidHalal - {{ restaurant.title }}
{% endblock %}
{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js" integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>
<style media="screen">
  a {
    color: #000000;
    text-decoration: none;
  }
  .popup__bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background: rgba(0,0,0,0.5);
      opacity: 0;
      pointer-events: none;
      transition: 0.5s all;
  }

.popup__bg.active {
    opacity: 1;
    pointer-events: all;
    transition: 0.5s all;
}

.popup {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    background: #fff;
    width: 400px;
    padding: 25px;
    transition: 0.5s all;
}

.popup.active {
    transform: translate(-50%, -50%) scale(1);
    transition: 0.5s all;
}

.close-popup {
    top: 10px;
    right: 10px;
    cursor: pointer;
}

.popup label {
    width: 100%;
    margin-bottom: 25px;
    display: flex;
    flex-direction: column-reverse;
}

.popup .label__text {
    font-size: 14px;
    text-transform: uppercase;
    font-weight: 500;
    color: #cfd0d3;
    margin-bottom: 5px;
}

.popup input {
    height: 45px;
    font-size: 18px;
    border: none;
    outline: none;
    border-bottom: 1px solid #cfd0d3;
}

.popup input:focus {
    border-bottom: 1px solid #2982ff;
}

.popup input:focus + .label__text {
    color: #2982ff;
}

.popup textarea {
    resize: none;
    width: 100%;
    height: 150px;
    border: none;
    outline: none;
    border-bottom: 1px solid #cfd0d3;
    font-size: 18px;
    padding-top: 5px;
}

.popup textarea:focus {
    border-bottom: 1px solid #2982ff;
}

.popup textarea:focus + .label__text {
    color: #2982ff;
}

.popup button {
    width: 100%;
    height: 45px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 18px;
    border: 2px solid #2982ff;
    background: #2982ff;
    cursor: pointer;
    text-transform: uppercase;
    transition: 0.5s all;
}

.popup button:hover {
    background: #fff;
    color:#2982ff;
    transition: 0.5s all;
}

.breadcrumb-area {
  z-index: 1 !important;
}
.single-widget-area{
  z-index: 0 !important;
}
.links-size{
  font-size: 30px;
  margin-right: 10px;
  color: #1e1e62;
}
</style>
<!-- ##### Breadcrumb Area Start ##### -->
<div class="breadcrumb-area">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{% url 'main' %}"><i class="fa fa-home"></i> Главная</a></li>
                        <li class="breadcrumb-item"><a href="{{ restaurant.category.get_absolute_url }}">{{ restaurant.category.title }}</a></li>
                        <li class="breadcrumb-item active" aria-current="page">{{ restaurant.title }}</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>
</div>
<!-- ##### Breadcrumb Area End ##### -->

<!-- ##### Blog Content Area Start ##### -->
<section class="blog-content-area section-padding-0-100">
    <div class="container">
        <div class="row justify-content-center">
            <!-- Blog Sidebar Area -->
            <div class="col-12 col-sm-9 col-md-6 col-lg-4">
              <div class="post-sidebar-area">

                <div class="single-widget-area mt-0">
                  <h2 class="post-title">{{ restaurant.category.title }} "{{ restaurant.title }}"</h2>
                  <h5 class="mt-5">Информация</h5>
                  <h6 class="mt-3">Адрес:</h6>
                  <span>{{ restaurant.address }}</span>
                  <br>
                  <a href="#" class="open-popup">На карте</a>
                  <div class="popup__bg">
                      <div class="popup">
                          {% if links.googlemaps %}
                              <a href="{{ links.googlemaps }}" target='_blank'><button type="submit">Google карта</button></a><br>
                          {% endif %}
                          {% if links.yandexmaps %}
                              <a href="{{ links.yandexmaps }}" target='_blank'><button type="submit">Yandex карта</button></a><br>
                          {% endif %}
                          {% if links.applemaps %}
                              <a href="{{ links.applemaps }}" target='_blank'><button type="submit">Apple карта</button></a><br>
                          {% endif %}
                          {% if links.gis %}
                              <a href="{{ links.gis }}" target='_blank'><button type="submit">2Gis карта</button></a><br>
                          {% endif %}
                          <button class="close-popup">Закрыть</button>
                      </div>
                  </div>
                  <h6 class="mt-3">Контакты:</h6>
                  <a href="tel:{{ restaurant.phone }}"><span>{{ restaurant.phone }}</span></a><br>
                  {% if links.instagram or links.facebook or links.own_site %}
                  <h6 class="mt-3">Соц. сети:</h6>
                      {% if links.instagram %}
                          <a href="{{ links.instagram }}" target="_blank"><i class="fa fa-instagram links-size" aria-hidden="true"></i></a>
                      {% endif %}
                      {% if links.facebook %}
                          <a href="{{ links.facebook }}" target="_blank"><i class="fa fa-facebook links-size" aria-hidden="true"></i></a>
                      {% endif %}
                      {% if restaurant.phone %}
                          <a href="https://wa.me/{{ restaurant.phone }}" target="_blank"><i class="fa fa-whatsapp links-size" aria-hidden="true"></i></a>
                      {% endif %}
                  {% endif %}
                  <h6 class="mt-3">Время работы:</h6>
                  {% for item in worktimes %}
                  <span>{{ item.get_weekday_display }}:</span>
                  <span> {{ item.from_hour }}-{{ item.to_hour }}</span>
                  <br>
                  {% endfor %}
                </div>



              </div>
            </div>


            <!-- Blog Posts Area -->
            <div class="col-12 col-lg-8">
                <div class="blog-posts-area">
                    <h4>Меню</h4>
                    <div class="single-widget-area">

                    <div class="accordion" id="accordionExample">
                    {% for item in categories %}
                        <div class="accordion-item">
                            <h6 class="accordion-header" id="heading-{{ item }}">
                              <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-{{ item }}" aria-expanded="true" aria-controls="collapse-{{ item }}">
                                {{ item }}
                              </button>
                            </h6>
                            <br>
                            <div id="collapse-{{ item }}" class="accordion-collapse collapse" aria-labelledby="heading-{{ item }}" data-bs-parent="#accordionExample">
                            {% for item_2 in products %}
                                {% if item == item_2.category.title %}
                                    <br>
                                    <div class="single-latest-post d-flex mb-3">
                                        <div class="post-thumb">
                                            <img src="{% if item_2.image %}
                                                          {{ item_2.image.url }}
                                                      {% else %}
                                                          {% static 'img/no_image.jpg' %}
                                                      {% endif %}" alt="">
                                        </div>
                                        <div class="post-content">
                                            <a href="#" class="post-title">
                                                <h6>{{ item_2.title }}</h6>
                                            </a>
                                            <span>{{ item_2.description }}</span><br>
                                            <span>{{ item_2.price }}₸</span>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                    </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
</section>
<!-- ##### Blog Content Area End ##### -->
<script type="text/javascript">
  let popupBg = document.querySelector('.popup__bg'); // Фон попап окна
  let popup = document.querySelector('.popup'); // Само окно
  let openPopupButtons = document.querySelectorAll('.open-popup'); // Кнопки для показа окна
  let closePopupButton = document.querySelector('.close-popup'); // Кнопка для скрытия окна

  openPopupButtons.forEach((button) => { // Перебираем все кнопки
      button.addEventListener('click', (e) => { // Для каждой вешаем обработчик событий на клик
          e.preventDefault(); // Предотвращаем дефолтное поведение браузера
          popupBg.classList.add('active'); // Добавляем класс 'active' для фона
          popup.classList.add('active'); // И для самого окна
      })
  });


  closePopupButton.addEventListener('click',() => { // Вешаем обработчик на крестик
    popupBg.classList.remove('active'); // Убираем активный класс с фона
    popup.classList.remove('active'); // И с окна
});

document.addEventListener('click', (e) => { // Вешаем обработчик на весь документ
    if(e.target === popupBg) { // Если цель клика - фот, то:
        popupBg.classList.remove('active'); // Убираем активный класс с фона
        popup.classList.remove('active'); // И с окна
    }
});
</script>
{% endblock %}
